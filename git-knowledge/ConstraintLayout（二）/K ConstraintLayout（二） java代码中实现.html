<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"/><meta name="exporter-version" content="Evernote Mac 6.11 (454874)"/><meta name="altitude" content="9.617091178894043"/><meta name="author" content="alanfujindong@gmail.com"/><meta name="created" content="2017-06-10 01:56:18 +0000"/><meta name="latitude" content="31.89309061649752"/><meta name="longitude" content="120.5216046877461"/><meta name="source" content="desktop.mac"/><meta name="updated" content="2017-06-10 06:17:19 +0000"/><title>K ConstraintLayout（二） java代码中实现</title></head><body><div>在 ConstraintLayout（一） 中讲解了constraintLayout 在 xml 文件中的属性设置，</div><div>本篇文章主要谈论的是ConstraintLayout 在java代码中动态效果的实现。</div><div>本篇文章的展示效果主要以gif + 代码注释为主。由简单到复杂。</div><div>源码地址：<a href="https://github.com/ScottFJD/Android-develop-skills">https://github.com/ScottFJD/Android-develop-skills</a></div><div><hr/></div><div>ConstraintLayout 布局图：</div><div><img src="K%20ConstraintLayout%EF%BC%88%E4%BA%8C%EF%BC%89%20java%E4%BB%A3%E7%A0%81%E4%B8%AD%E5%AE%9E%E7%8E%B0.resources/DABE7EA8-3178-425F-B380-45CAE06BB0F8.png" height="898" width="502"/><br/></div><div><br/></div><div>Activity代码（这里只显示了部分代码 ）：</div><div style="box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-top-left-radius: 4px; border-top-right-radius: 4px; border-bottom-right-radius: 4px; border-bottom-left-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.14902); background-position: initial initial; background-repeat: initial initial;-en-codeblock:true;"><div><br/></div><div><span>public class </span><span>ConstraintLayoutAnimationsActivity </span><span>extends </span><span>AppCompatActivity {</span></div><div><br/></div><div><span>    </span><span>private </span><span>ConstraintLayout </span><span>constraintLayout</span><span>;</span></div><div><span>    private </span><span>ConstraintSet </span><span>applyConstraintSet </span><span>= </span><span>new </span><span>ConstraintSet()</span><span>;</span></div><div><span>    private </span><span>ConstraintSet </span><span>resetConstraintSet </span><span>= </span><span>new </span><span>ConstraintSet()</span><span>;</span></div><div><br/><span>    </span><span>@Override</span></div><div><span>    </span><span>protected void </span><span>onCreate</span><span>(</span><span>@Nullable </span><span>Bundle savedInstanceState) {</span></div><div><span>        </span><span>super</span><span>.onCreate(savedInstanceState)</span><span>;</span></div><div><span>        </span><span>setContentView(R.layout.</span><span style="font-style: italic;">activity_constraint_animations</span><span>)</span><span>;</span></div><div><span>        </span><span>constraintLayout </span><span>= (ConstraintLayout) findViewById(R.id.</span><span style="font-style: italic;">cl_content</span><span>)</span><span>;</span></div><div>       <span style="background-color: rgb(255, 250, 165);-evernote-highlight:true;" /><span style="background-color: rgb(255, 250, 165);-evernote-highlight:true;"><span>resetConstraintSet</span><span>.clone(</span><span>constraintLayout</span><span>)</span><span>;</span></span></div><div><span style="background-color: rgb(255, 250, 165);-evernote-highlight:true;"><span>        </span><span>applyConstraintSet</span><span>.clone(</span><span>constraintLayout</span><span>)</span><span>;</span></span></div><div><br/><span>    </span><span>}</span></div><div><span><br/></span></div><div><span>    </span><span>@TargetApi</span><span>(</span><span>19</span><span>)</span></div><div><span>    </span><span>public void </span><span>onResetClick</span><span>(View view) {</span></div><div><span><br/></span></div><div><span>        </span><span>if </span><span>(Build.VERSION.</span><span style="font-style: italic;">SDK_INT </span><span>&gt;= </span><span>19</span><span>) {</span></div><div><span><br/></span></div><div><span>            TransitionManager.</span><span style="font-style: italic;">beginDelayedTransition</span><span>(</span><span>constraintLayout</span><span>)</span><span>;</span></div><div><span>        </span><span>}</span></div><div><span><br/></span></div><div>       <span style="background-color: rgb(255, 250, 165);-evernote-highlight:true;" /><span style="background-color: rgb(255, 250, 165);-evernote-highlight:true;"><span>resetConstraintSet</span><span>.applyTo(</span><span>constraintLayout</span><span>)</span><span>;</span></span></div><div><span>    </span><span>}</span></div><div><br/></div><div><br/></div><div><span style="font-style: italic;">   </span><span>@TargetApi</span><span>(</span><span>19</span><span>)</span></div><div><span>    </span><span>public void </span><span>onApplyClick</span><span>(View view) {</span></div><div><br/></div><div><span>        </span><span>setMargin()</span><span>;</span></div><div><span>}</span></div></div><div><br/></div><div><ul/></div><div><span style="font-size: 18px;">案例一：</span></div><div><img src="K%20ConstraintLayout%EF%BC%88%E4%BA%8C%EF%BC%89%20java%E4%BB%A3%E7%A0%81%E4%B8%AD%E5%AE%9E%E7%8E%B0.resources/2017-06-10%2010.19.58.gif" height="1554" width="868"/><br/></div><div><br/></div><div><br/></div><div><ul><li>setMargin<br/></li></ul></div><div style="text-align: start;"><span><span>    <span>    <span>    </span></span></span>void setMargin (int viewId，</span>int anchor,int value)</div><div style="text-align: start;"><span><span>    <span>    <span>    </span></span></span>Sets the margin.</span></div><table style="width: 100%; border-collapse: collapse; table-layout: fixed;"><tbody><tr><td style="border: 1px solid rgb(219, 219, 219); padding: 10px; margin: 0px; width: 50%; min-width: 50%;"><div>Parameters</div></td><td style="border: 1px solid rgb(219, 219, 219); padding: 10px; margin: 0px; width: 50%; min-width: 50%;"><div><br/></div></td></tr><tr><td style="padding: 10px; text-align: left; background-color: inherit; border: 1px solid rgb(221, 221, 221); margin: 0px;"><div><span>viewId</span></div></td><td style="padding: 10px; text-align: left; background-color: inherit; border: 1px solid rgb(221, 221, 221); margin: 0px;" width="100%"><div><span>int</span>: ID of view to adjust the margin on </div></td></tr><tr><td style="padding: 10px; text-align: left; background-color: inherit; border: 1px solid rgb(221, 221, 221); margin: 0px;"><div><span>anchor</span></div></td><td style="padding: 10px; text-align: left; background-color: inherit; border: 1px solid rgb(221, 221, 221); margin: 0px;" width="100%"><div><span>int</span>: The side to adjust the margin on </div></td></tr><tr><td style="padding: 10px; text-align: left; background-color: inherit; border: 1px solid rgb(221, 221, 221); margin: 0px;"><div><span>value</span></div></td><td style="padding: 10px; text-align: left; background-color: inherit; border: 1px solid rgb(221, 221, 221); margin: 0px;" width="100%"><div><span>int</span>: The new value for the margin </div></td></tr></tbody></table><div><br/></div><div><span style="color: #9876aa;">applyConstraintSet</span>.setMargin(R.id.<span style="color: #9876aa; font-style: italic;">button8</span><span style="color: #cc7832;">, </span>ConstraintSet.<span style="color: #9876aa; font-style: italic;">START</span><span style="color: #cc7832;">, </span><span style="color: #6897bb;">8</span>)<span style="color: #cc7832;">;</span></div><div><br/></div><div><br/></div><div><ul><li>TransitionManger</li></ul><div><span>    观察动图会发现点击apply应用的时候 按钮的移动又点僵硬一闪就过去了。在点击reset的时候会有一个滑动过渡的效果。实现发放如下：</span><br/></div></div><div><span><span>    如果项目开发minSDKVersion为 19 可以直接引用</span></span></div><div><span><span>    </span>public void </span><span>onResetClick</span><span>(View view) {</span></div><div><span>       <span>    </span> TransitionManager.</span><span style="font-style: italic;">beginDelayedTransition</span><span>(</span><span>constraintLayout</span><span>)</span><span>;</span><span>    </span></div><div><span><span>    </span>    </span><span>resetConstraintSet</span><span>.applyTo(</span><span>constraintLayout</span><span>)</span><span>;</span></div><div><span><span>    </span>}</span></div><div><span><span>    如果低于19 版本 就需要添加TransitionManager API 在 gradle 中添加依赖</span></span></div><div><span style="font-family: SFMono-Regular, Consolas, 'Liberation Mono', Menlo, Courier, monospace; font-size: 13.600000381469727px;"><span>    <span>    </span></span>compile 'com.android.support:transition:25.1.0'</span></div><div><span>    当然也可以这样写：</span></div><div style="box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-top-left-radius: 4px; border-top-right-radius: 4px; border-bottom-right-radius: 4px; border-bottom-left-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.14902); background-position: initial initial; background-repeat: initial initial;-en-codeblock:true;"><div><span>@TargetApi</span><span>(</span><span>19</span><span>)</span></div><div><span>public void </span><span>onResetClick</span><span>(View view) {</span></div><div><span>    </span><span>if </span><span>(Build.VERSION.</span><span style="font-style: italic;">SDK_INT </span><span>&gt;= </span><span>19</span><span>) {</span></div><div><span>        TransitionManager.</span><span style="font-style: italic;">beginDelayedTransition</span><span>(</span><span>constraintLayout</span><span>)</span><span>;</span><span>    </span><span>}</span></div><div><span>    </span><span>resetConstraintSet</span><span>.applyTo(</span><span>constraintLayout</span><span>)</span><span>;</span><span>}</span></div></div><div><br/></div><ul/><div>添加@TargetApi(19)之后就算minSDKVersion 为14 lint也不会报错。但是一定要在使用TransitionManager 的时候加上版本判断。</div><div><br/></div><div>实现代码：</div><div>@TargetApi(19)</div><div>public void onApplyClick(View view) {</div><div>    if (Build.VERSION.<span style="font-style: italic;">SDK_INT </span>&gt;= 19) {</div><div>        TransitionManager.<span style="font-style: italic;">beginDelayedTransition</span>(constraintLayout);</div><div>    }</div><div><span>    </span>setMargin();<br/></div><div>    resetConstraintSet.applyTo(constraintLayout);</div><div>}</div><div><span><span>    </span>private void </span><span>setMargin</span><span>() {</span></div><div><span>   <span>    </span> </span><span>//        设置边距</span><span>    </span></div><div><span><span>    </span>applyConstraintSet</span><span>.setMargin(R.id.</span><span style="font-style: italic;">button8</span><span>, </span><span>ConstraintSet.</span><span style="font-style: italic;">START</span><span>, </span><span>8</span><span>)</span><span>;</span><span/></div><div><span>    </span>}</div><div><br/></div><div><font style="font-size: 18px;">案例二：</font></div><div><img src="K%20ConstraintLayout%EF%BC%88%E4%BA%8C%EF%BC%89%20java%E4%BB%A3%E7%A0%81%E4%B8%AD%E5%AE%9E%E7%8E%B0.resources/2017-06-10%2013.18.03.gif" height="1550" width="878"/><br/></div><div><span><br/></span></div><ul><li>centerHorizontally</li></ul><div><span>    <span>    </span></span>centerHorizontally<br/></div><div style="text-align: start;"><span>void centerHorizontally (int viewId, </span></div><div style="text-align: start;"><span>                int toView)</span></div><div style="text-align: start;"><span>Centers the view horizontally relative to toView's position.</span></div><div><br/></div><table style="width: 100%; border-collapse: collapse; table-layout: fixed;"><tbody><tr><td style="border: 1px solid rgb(219, 219, 219); padding: 10px; margin: 0px; width: 50%; min-width: 50%;"><div>Parameters</div></td><td style="border: 1px solid rgb(219, 219, 219); padding: 10px; margin: 0px; width: 50%; min-width: 50%;"><div><br/></div></td></tr><tr><td style="padding: 10px; text-align: left; background-color: inherit; border: 1px solid rgb(221, 221, 221); margin: 0px;"><div><span>viewId</span></div></td><td style="padding: 10px; text-align: left; background-color: inherit; border: 1px solid rgb(221, 221, 221); margin: 0px;" width="100%"><div><span>int</span>: ID of view to center Horizontally </div></td></tr><tr><td style="padding: 10px; text-align: left; background-color: inherit; border: 1px solid rgb(221, 221, 221); margin: 0px;"><div><span>toView</span></div></td><td style="padding: 10px; text-align: left; background-color: inherit; border: 1px solid rgb(221, 221, 221); margin: 0px;" width="100%"><div><span>int</span>: ID of view to center on (or in) </div></td></tr></tbody></table><div><br/></div><div><br/></div><div> 实现代码：</div><div style="box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-top-left-radius: 4px; border-top-right-radius: 4px; border-bottom-right-radius: 4px; border-bottom-left-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.14902); background-position: initial initial; background-repeat: initial initial;-en-codeblock:true;"><div>private void setCenterHorizontally() {</div><div>//让三个按钮都水平居中 要让三个按钮水平居中的时候两边能对齐 去掉两边的margin距离</div><div>applyConstraintSet.setMargin(R.id.<span style="font-style: italic;">button8</span>, ConstraintSet.<span style="font-style: italic;">START</span>,0);                                applyConstraintSet.setMargin(R.id.<span style="font-style: italic;">button8</span>,ConstraintSet.<span style="font-style: italic;">END</span>,0);    applyConstraintSet.setMargin(R.id.<span style="font-style: italic;">button9</span>,ConstraintSet.<span style="font-style: italic;">START</span>,0);    applyConstraintSet.setMargin(R.id.<span style="font-style: italic;">button9</span>,ConstraintSet.<span style="font-style: italic;">END</span>,0);     applyConstraintSet.setMargin(R.id.<span style="font-style: italic;">button10</span>,ConstraintSet.<span style="font-style: italic;">START</span>,0);    applyConstraintSet.setMargin(R.id.<span style="font-style: italic;">button10</span>,ConstraintSet.<span style="font-style: italic;">END</span>,0);</div><div><br/></div><div>applyConstraintSet.centerHorizontally(R.id.<span style="font-style: italic;">button8</span>,<a href="http://R.id">R.id</a>.<span style="font-style: italic;">cl_content</span>);    applyConstraintSet.centerHorizontally(R.id.<span style="font-style: italic;">button9</span>,<a href="http://R.id">R.id</a>.<span style="font-style: italic;">cl_content</span>);    applyConstraintSet.centerHorizontally(R.id.<span style="font-style: italic;">button10</span>,<a href="http://R.id">R.id</a>.<span style="font-style: italic;">cl_content</span>);}</div></div><div><br/></div><div><br/></div><div><font style="font-size: 18px;">案例三：</font></div><div><img src="K%20ConstraintLayout%EF%BC%88%E4%BA%8C%EF%BC%89%20java%E4%BB%A3%E7%A0%81%E4%B8%AD%E5%AE%9E%E7%8E%B0.resources/2017-06-10%2013.29.01.gif" height="1470" width="886"/><br/></div><div><br/></div><div>让控件水平 垂直方向居中</div><div>实现代码：</div><div style="box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-top-left-radius: 4px; border-top-right-radius: 4px; border-bottom-right-radius: 4px; border-bottom-left-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.14902); background-position: initial initial; background-repeat: initial initial;-en-codeblock:true;"><div><span>private void </span><span>setCenterHorizontallyVertically</span><span>() {</span></div><div><span>    </span><span>//        移动第按钮10 到父布局的中心</span><span>    <span>    <span>    <span>     </span></span></span></span><span>applyConstraintSet</span><span>.setMargin(R.id.</span><span style="font-style: italic;">button10</span><span>, </span><span>ConstraintSet.</span><span style="font-style: italic;">START</span><span>, </span><span>0</span><span>)</span><span>;</span><span>    </span><span>applyConstraintSet</span><span>.setMargin(R.id.</span><span style="font-style: italic;">button10</span><span>, </span><span>ConstraintSet.</span><span style="font-style: italic;">END</span><span>, </span><span>0</span><span>)</span><span>;</span><span>    </span><span>applyConstraintSet</span><span>.setMargin(R.id.</span><span style="font-style: italic;">button10</span><span>, </span><span>ConstraintSet.</span><span style="font-style: italic;">TOP</span><span>, </span><span>0</span><span>)</span><span>;</span><span>    </span><span>applyConstraintSet</span><span>.setMargin(R.id.</span><span style="font-style: italic;">button10</span><span>, </span><span>ConstraintSet.</span><span style="font-style: italic;">BOTTOM</span><span>, </span><span>0</span><span>)</span><span>;</span></div><div><br/><span>    </span><span>applyConstraintSet</span><span>.centerHorizontally(R.id.</span><span style="font-style: italic;">button10</span><span>, </span><a href="http://R.id">R.id</a><span>.</span><span style="font-style: italic;">cl_content</span><span>)</span><span>;</span></div><div><span>    </span><span>applyConstraintSet</span><span>.centerVertically(R.id.</span><span style="font-style: italic;">button10</span><span>, </span><a href="http://R.id">R.id</a><span>.</span><span style="font-style: italic;">cl_content</span><span>)</span><span>;</span><span>}</span></div></div><ul/><div><br/></div><div><br/></div><div><font style="font-size: 18px;">案例四：</font></div><div><img src="K%20ConstraintLayout%EF%BC%88%E4%BA%8C%EF%BC%89%20java%E4%BB%A3%E7%A0%81%E4%B8%AD%E5%AE%9E%E7%8E%B0.resources/2017-06-10%2013.45.29.gif" height="1440" width="878"/><br/></div><div><br/></div><div><span>    设置控件 宽／高</span><br/></div><div>     实现代码：</div><div style="box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-top-left-radius: 4px; border-top-right-radius: 4px; border-bottom-right-radius: 4px; border-bottom-left-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.14902); background-position: initial initial; background-repeat: initial initial;-en-codeblock:true;"><div><span>private void </span><span>setWidthHeight</span><span>() {</span></div><div><span>    </span><span>//      设置按钮宽度／高度</span><span>    </span><span>applyConstraintSet</span><span>.constrainWidth(R.id.</span><span style="font-style: italic;">button8</span><span>,</span><span>600</span><span>)</span><span>;</span><span>    </span><span>applyConstraintSet</span><span>.constrainHeight(R.id.</span><span style="font-style: italic;">button8</span><span>,</span><span>400</span><span>)</span><span>;</span></div><div><span>}</span></div></div><div><br/></div><div><br/></div><div><br/></div><div><font style="font-size: 18px;">案例五：</font></div><div><img src="K%20ConstraintLayout%EF%BC%88%E4%BA%8C%EF%BC%89%20java%E4%BB%A3%E7%A0%81%E4%B8%AD%E5%AE%9E%E7%8E%B0.resources/2017-06-10%2013.49.14.gif" height="1494" width="880"/><br/></div><div><span>    </span><br/></div><div><span><span>    隐藏控件，铺满父布局</span><br/></span></div><ul><li>Connect</li></ul><div style="text-align: start;"><span>void connect (int startID, </span></div><div style="text-align: start;"><span>                int startSide, </span></div><div style="text-align: start;"><span>                int endID, </span></div><div style="text-align: start;"><span>                int endSide, </span></div><div style="text-align: start;"><span>                int margin)</span></div><div style="text-align: start;"><span>Create a constraint between two widgets.</span></div><div><br/></div><table style="width: 100%; border-collapse: collapse; table-layout: fixed;"><tbody><tr><td style="border: 1px solid rgb(219, 219, 219); padding: 10px; margin: 0px; width: 50%; min-width: 50%;"><div>Parameters</div></td><td style="border: 1px solid rgb(219, 219, 219); padding: 10px; margin: 0px; width: 50%; min-width: 50%;"><div><br/></div></td></tr><tr><td style="padding: 10px; text-align: left; background-color: inherit; border: 1px solid rgb(221, 221, 221); margin: 0px;"><div><span>startID</span></div></td><td style="padding: 10px; text-align: left; background-color: inherit; border: 1px solid rgb(221, 221, 221); margin: 0px;" width="100%"><div><span>int</span>: the ID of the widget to be constrained </div></td></tr><tr><td style="padding: 10px; text-align: left; background-color: inherit; border: 1px solid rgb(221, 221, 221); margin: 0px;"><div><span>startSide</span></div></td><td style="padding: 10px; text-align: left; background-color: inherit; border: 1px solid rgb(221, 221, 221); margin: 0px;" width="100%"><div><span>int</span>: the side of the widget to constrain </div></td></tr><tr><td style="padding: 10px; text-align: left; background-color: inherit; border: 1px solid rgb(221, 221, 221); margin: 0px;"><div><span>endID</span></div></td><td style="padding: 10px; text-align: left; background-color: inherit; border: 1px solid rgb(221, 221, 221); margin: 0px;" width="100%"><div><span>int</span>: the id of the widget to constrain to </div></td></tr><tr><td style="padding: 10px; text-align: left; background-color: inherit; border: 1px solid rgb(221, 221, 221); margin: 0px;"><div><span>endSide</span></div></td><td style="padding: 10px; text-align: left; background-color: inherit; border: 1px solid rgb(221, 221, 221); margin: 0px;" width="100%"><div><span>int</span>: the side of widget to constrain to </div></td></tr><tr><td style="padding: 10px; text-align: left; background-color: inherit; border: 1px solid rgb(221, 221, 221); margin: 0px;"><div><span>margin</span></div></td><td style="padding: 10px; text-align: left; background-color: inherit; border: 1px solid rgb(221, 221, 221); margin: 0px;" width="100%"><div><span>int</span>: the margin to constrain (margin must be postive) </div></td></tr></tbody></table><div><br/></div><span><span/></span><div>实现代码：</div><div style="box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-top-left-radius: 4px; border-top-right-radius: 4px; border-bottom-right-radius: 4px; border-bottom-left-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.14902); background-position: initial initial; background-repeat: initial initial;-en-codeblock:true;"><div><span /><span style="font-style: italic;">/**</span></div><div><span style="font-style: italic;">     * 隐藏其他按钮 让这个按钮铺满父控件</span></div><div><span style="font-style: italic;">     * 这里要注意的是 ConstraintLayout 具有FrameLayout 的特性 如果铺满的是</span></div><div><span style="font-style: italic;">     * 第一个放置的按钮 那么后面添加的按钮会显示在齐上面</span></div><div><span style="font-style: italic;">     */</span></div><div><span style="font-style: italic;">    </span><span>private void </span><span>setVisibilityAndClearAndConnect</span><span>() {</span></div><div><br/></div><div><span>        </span></div><div><span>applyConstraintSet</span><span>.setVisibility(R.id.</span><span style="font-style: italic;">button9</span><span>, </span><span>ConstraintSet.</span><span style="font-style: italic;">GONE</span><span>)</span><span>;</span><span>        </span><span>applyConstraintSet</span><span>.setVisibility(R.id.</span><span style="font-style: italic;">button10</span><span>, </span><span>ConstraintSet.</span><span style="font-style: italic;">GONE</span><span>)</span><span>;</span><br/><br/><span>//        没有约束关系的时候setMargin 是无效的</span></div><div><span>//        applyConstraintSet.setMargin(R.id.button13, ConstraintSet.START, 0);</span></div><div><span>//        applyConstraintSet.setMargin(R.id.button13, ConstraintSet.END, 0);</span></div><div><span>//        applyConstraintSet.setMargin(R.id.button13, ConstraintSet.TOP, 0);</span></div><div><span>//        applyConstraintSet.setMargin(R.id.button13, ConstraintSet.BOTTOM, 0);</span></div><div/><div>//clear 的意思是清除此按钮所有constraint属性          applyConstraintSet.clear(R.id.<span style="font-style: italic;">button13</span>);</div><div><br/></div><div>        applyConstraintSet.connect(R.id.<span style="font-style: italic;">button13</span>, ConstraintSet.<span style="font-style: italic;">LEFT</span>, <a href="http://R.id">R.id</a>.<span style="font-style: italic;">cl_content</span>, ConstraintSet.<span style="font-style: italic;">LEFT</span>, 0);//connect 连接两个控件的边缘并设置margin</div><div>        applyConstraintSet.connect(R.id.<span style="font-style: italic;">button13</span>, ConstraintSet.<span style="font-style: italic;">RIGHT</span>, <a href="http://R.id">R.id</a>.<span style="font-style: italic;">cl_content</span>, ConstraintSet.<span style="font-style: italic;">RIGHT</span>, 0);</div><div>        applyConstraintSet.connect(R.id.<span style="font-style: italic;">button13</span>, ConstraintSet.<span style="font-style: italic;">TOP</span>, <a href="http://R.id">R.id</a>.<span style="font-style: italic;">cl_content</span>, ConstraintSet.<span style="font-style: italic;">TOP</span>, 0);</div><div>        applyConstraintSet.connect(R.id.<span style="font-style: italic;">button13</span>, ConstraintSet.<span style="font-style: italic;">BOTTOM</span>, <a href="http://R.id">R.id</a>.<span style="font-style: italic;">cl_content</span>, ConstraintSet.<span style="font-style: italic;">BOTTOM</span>, 0);    }</div></div><div> </div><div><br/></div><div><font style="font-size: 18px;">案例六：</font></div><div><img src="K%20ConstraintLayout%EF%BC%88%E4%BA%8C%EF%BC%89%20java%E4%BB%A3%E7%A0%81%E4%B8%AD%E5%AE%9E%E7%8E%B0.resources/2017-06-10%2013.56.52.gif" height="1490" width="878"/><br/></div><div><br/></div><div>实现 chain bias</div><div><br/></div><ul><li>createHorizontalChain</li></ul><div style="text-align: start;"><span>void createHorizontalChain (int leftId, </span></div><div style="text-align: start;"><span>                int leftSide, </span></div><div style="text-align: start;"><span>                int rightId, </span></div><div style="text-align: start;"><span>                int rightSide, </span></div><div style="text-align: start;"><span>                int[] chainIds, </span></div><div style="text-align: start;"><span>                float[] weights, </span></div><div style="text-align: start;"><span>                int style)</span></div><div style="text-align: start;"><span>Spaces a set of widgets horizontal between the view startID and endId. Widgets can be spaced with weights.</span></div><div><br/></div><table style="color: rgba(0, 0, 0, 0.68); font-family: Roboto, sans-serif; font-size: 14px; text-align: start; background-color: rgb(255, 255, 255); width: 100%; border-collapse: collapse; table-layout: fixed;"><tbody><tr><td style="border: 1px solid rgb(219, 219, 219); padding: 10px; margin: 0px; width: 50%; min-width: 50%;"><div>Parameters</div></td><td style="border: 1px solid rgb(219, 219, 219); padding: 10px; margin: 0px; width: 50%; min-width: 50%;"><div><br/></div></td></tr><tr><td style="padding: 10px; text-align: left; background-color: inherit; border: 1px solid rgb(221, 221, 221); margin: 0px;"><div><span>leftId</span></div></td><td style="padding: 10px; text-align: left; background-color: inherit; border: 1px solid rgb(221, 221, 221); margin: 0px;" width="100%"><div><span>int</span>: The id of the widget to connect to or PARENT_ID </div></td></tr><tr><td style="padding: 10px; text-align: left; background-color: inherit; border: 1px solid rgb(221, 221, 221); margin: 0px;"><div><span>leftSide</span></div></td><td style="padding: 10px; text-align: left; background-color: inherit; border: 1px solid rgb(221, 221, 221); margin: 0px;" width="100%"><div><span>int</span>: the side of the start to connect to </div></td></tr><tr><td style="padding: 10px; text-align: left; background-color: inherit; border: 1px solid rgb(221, 221, 221); margin: 0px;"><div><span>rightId</span></div></td><td style="padding: 10px; text-align: left; background-color: inherit; border: 1px solid rgb(221, 221, 221); margin: 0px;" width="100%"><div><span>int</span>: The id of the widget to connect to or PARENT_ID </div></td></tr><tr><td style="padding: 10px; text-align: left; background-color: inherit; border: 1px solid rgb(221, 221, 221); margin: 0px;"><div><span>rightSide</span></div></td><td style="padding: 10px; text-align: left; background-color: inherit; border: 1px solid rgb(221, 221, 221); margin: 0px;" width="100%"><div><span>int</span>: the side of the right to connect to </div></td></tr><tr><td style="padding: 10px; text-align: left; background-color: inherit; border: 1px solid rgb(221, 221, 221); margin: 0px;"><div><span>chainIds</span></div></td><td style="padding: 10px; text-align: left; background-color: inherit; border: 1px solid rgb(221, 221, 221); margin: 0px;" width="100%"><div><span>int</span>: The widgets in the chain </div></td></tr><tr><td style="padding: 10px; text-align: left; background-color: inherit; border: 1px solid rgb(221, 221, 221); margin: 0px;"><div><span>weights</span></div></td><td style="padding: 10px; text-align: left; background-color: inherit; border: 1px solid rgb(221, 221, 221); margin: 0px;" width="100%"><div><span>float</span>: The weight to assign to each element in the chain or null </div></td></tr><tr><td style="padding: 10px; text-align: left; background-color: inherit; border: 1px solid rgb(221, 221, 221); margin: 0px;"><div><span>style</span></div></td><td style="padding: 10px; text-align: left; background-color: inherit; border: 1px solid rgb(221, 221, 221); margin: 0px;" width="100%"><div><span>int</span>: The type of chain</div></td></tr></tbody></table><h3 style="text-align: start;"><ul/></h3><ul><li>setHorizontalBias</li></ul><div style="text-align: start;"><span>void setHorizontalBias (int viewId, </span></div><div style="text-align: start;"><span>                float bias)</span></div><div style="text-align: start;"><span>Adjust the horizontal bias of the view (used with views constrained on left and right).</span></div><div><br/></div><table style="width: 100%; border-collapse: collapse; table-layout: fixed;"><tbody><tr><td style="border: 1px solid rgb(219, 219, 219); padding: 10px; margin: 0px; width: 50%; min-width: 50%;"><div>Parameters</div></td><td style="border: 1px solid rgb(219, 219, 219); padding: 10px; margin: 0px; width: 50%; min-width: 50%;"><div><br/></div></td></tr><tr><td style="padding: 10px; text-align: left; background-color: inherit; border: 1px solid rgb(221, 221, 221); margin: 0px;"><div><span>viewId</span></div></td><td style="padding: 10px; text-align: left; background-color: inherit; border: 1px solid rgb(221, 221, 221); margin: 0px;" width="100%"><div><span>int</span>: ID of view to adjust the horizontal </div></td></tr><tr><td style="padding: 10px; text-align: left; background-color: inherit; border: 1px solid rgb(221, 221, 221); margin: 0px;"><div><span>bias</span></div></td><td style="padding: 10px; text-align: left; background-color: inherit; border: 1px solid rgb(221, 221, 221); margin: 0px;" width="100%"><div><span>float</span>: the new bias 0.5 is in the middle </div></td></tr></tbody></table><div><br/></div><div>实现代码：</div><div style="box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-top-left-radius: 4px; border-top-right-radius: 4px; border-bottom-right-radius: 4px; border-bottom-left-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.14902); background-position: initial initial; background-repeat: initial initial;-en-codeblock:true;"><div><br/></div><div><span>    </span><span>private void </span><span>setHorizontalChain</span><span>() {</span></div><div><span>        </span><span>applyConstraintSet</span><span>.clear(R.id.</span><span style="font-style: italic;">button8</span><span>)</span><span>;</span></div><div><span>        </span><span>applyConstraintSet</span><span>.clear(R.id.</span><span style="font-style: italic;">button9</span><span>)</span><span>;</span></div><div><span>        </span><span>applyConstraintSet</span><span>.clear(R.id.</span><span style="font-style: italic;">button10</span><span>)</span><span>;</span></div><div><br/><span>        </span><span>applyConstraintSet</span><span>.connect(R.id.</span><span style="font-style: italic;">button8</span><span>, </span><span>ConstraintSet.</span><span style="font-style: italic;">LEFT</span><span>,</span><a href="http://R.id">R.id</a><span>.</span><span style="font-style: italic;">cl_content</span><span>,</span><span>ConstraintSet.</span><span style="font-style: italic;">LEFT</span><span>,</span><span>0</span><span>)</span><span>;</span>   applyConstraintSet.connect(R.id.<span style="font-style: italic;">button10</span>,ConstraintSet.<span style="font-style: italic;">RIGHT</span>,<a href="http://R.id">R.id</a>.<span style="font-style: italic;">cl_content</span>,ConstraintSet.<span style="font-style: italic;">RIGHT</span>,0);</div><div><span>        </span><span>applyConstraintSet</span><span>.connect(R.id.</span><span style="font-style: italic;">button9</span><span>, </span><span>ConstraintSet.</span><span style="font-style: italic;">LEFT</span><span>, </span><a href="http://R.id">R.id</a><span>.</span><span style="font-style: italic;">button8</span><span>, </span><span>ConstraintSet.</span><span style="font-style: italic;">RIGHT</span><span>, </span><span>0</span><span>)</span><span>;</span></div><div><span>        </span><span>applyConstraintSet</span><span>.connect(R.id.</span><span style="font-style: italic;">button8</span><span>, </span><span>ConstraintSet.</span><span style="font-style: italic;">RIGHT</span><span>, </span><a href="http://R.id">R.id</a><span>.</span><span style="font-style: italic;">button9</span><span>, </span><span>ConstraintSet.</span><span style="font-style: italic;">LEFT</span><span>, </span><span>0</span><span>)</span><span>;</span></div><div><span>        </span><span>applyConstraintSet</span><span>.connect(R.id.</span><span style="font-style: italic;">button9</span><span>, </span><span>ConstraintSet.</span><span style="font-style: italic;">RIGHT</span><span>, </span><a href="http://R.id">R.id</a><span>.</span><span style="font-style: italic;">button10</span><span>, </span><span>ConstraintSet.</span><span style="font-style: italic;">LEFT</span><span>, </span><span>0</span><span>)</span><span>;</span></div><div><span>        </span><span>applyConstraintSet</span><span>.connect(R.id.</span><span style="font-style: italic;">button10</span><span>, </span><span>ConstraintSet.</span><span style="font-style: italic;">LEFT</span><span>, </span><a href="http://R.id">R.id</a><span>.</span><span style="font-style: italic;">button9</span><span>, </span><span>ConstraintSet.</span><span style="font-style: italic;">RIGHT</span><span>, </span><span>0</span><span>)</span><span>;</span><br/><span>//        createHorizontalChain 参数的官方说明与之前的版本有变动</span></div><div><span>//         leftId  int: The id of the widget to connect to or PARENT_ID</span></div><div><span>//        leftSide int: the side of the start to connect to</span></div><div><span>//        rightId  int: The id of the widget to connect to or PARENT_ID</span></div><div><span>//        rightSide    int: the side of the right to connect to</span></div><div><span>//        chainIds int: The widgets in the chain</span></div><div><span>//        weights  float: The weight to assign to each element in the chain or null</span></div><div><span>//        style    int: The type of chain</span><span>        </span><span>applyConstraintSet</span><span>.createHorizontalChain(R.id.</span><span style="font-style: italic;">cl_content</span><span>,</span><span>ConstraintSet.</span><span style="font-style: italic;">LEFT</span><span>,</span><a href="http://R.id">R.id</a><span>.</span><span style="font-style: italic;">cl_content</span><span>,</span><span>ConstraintSet.</span><span style="font-style: italic;">RIGHT</span><span>,</span>            </div><div><span>new int</span><span>[]{R.id.</span><span style="font-style: italic;">button8</span><span>,</span><a href="http://R.id">R.id</a><span>.</span><span style="font-style: italic;">button9</span><span>,</span><a href="http://R.id">R.id</a><span>.</span><span style="font-style: italic;">button10</span><span>}</span><span>,null, </span><span>ConstraintWidget.</span><span style="font-style: italic;">CHAIN_PACKED</span><span>)</span><span>;</span><br/><span>        </span><span>applyConstraintSet</span><span>.constrainWidth(R.id.</span><span style="font-style: italic;">button8</span><span>,</span><span>ConstraintSet.</span><span style="font-style: italic;">WRAP_CONTENT</span><span>)</span><span>;</span><span>        </span><span>applyConstraintSet</span><span>.constrainHeight(R.id.</span><span style="font-style: italic;">button8</span><span>,</span><span>ConstraintSet.</span><span style="font-style: italic;">WRAP_CONTENT</span><span>)</span><span>;</span><span>        </span><span>applyConstraintSet</span><span>.constrainWidth(R.id.</span><span style="font-style: italic;">button9</span><span>,</span><span>ConstraintSet.</span><span style="font-style: italic;">WRAP_CONTENT</span><span>)</span><span>;</span><span>        </span><span>applyConstraintSet</span><span>.constrainHeight(R.id.</span><span style="font-style: italic;">button9</span><span>,</span><span>ConstraintSet.</span><span style="font-style: italic;">WRAP_CONTENT</span><span>)</span><span>;</span><span>        </span><span>applyConstraintSet</span><span>.constrainWidth(R.id.</span><span style="font-style: italic;">button10</span><span>,</span><span>ConstraintSet.</span><span style="font-style: italic;">WRAP_CONTENT</span><span>)</span><span>;</span><span>        </span><span>applyConstraintSet</span><span>.constrainHeight(R.id.</span><span style="font-style: italic;">button10</span><span>,</span><span>ConstraintSet.</span><span style="font-style: italic;">WRAP_CONTENT</span><span>)</span><span>;</span><br/><span>        </span><span>applyConstraintSet</span><span>.setHorizontalBias(R.id.</span><span style="font-style: italic;">button8</span><span>, </span><span>0.8f</span><span>)</span><span>;</span><span>//设置偏移比例</span><br/><span>    </span><span>}</span></div></div><div><br/></div><div>案例七：</div><div><img src="K%20ConstraintLayout%EF%BC%88%E4%BA%8C%EF%BC%89%20java%E4%BB%A3%E7%A0%81%E4%B8%AD%E5%AE%9E%E7%8E%B0.resources/2017-06-10%2014.03.50.gif" height="1550" width="898"/><br/></div><div><br/></div><div>官方ConstraintSet的案例代码，ConstraintSet加载两个不同的布局实现切换，布局中控件的id是一致的。</div><div><br/></div><div>好了，到这里ConstraintLayout XML java中的实现都分享完了。至于在视图框中进行拖拽编辑之类的多摸索尝试就清除了，就不再做介绍了。</div><div>以上所有案例都收录在我的github  Android-devlop-skills 仓库下，内有很多实用技巧，不断更新中。。。地址：<a href="https://github.com/ScottFJD/Android-develop-skills">https://github.com/ScottFJD/Android-develop-skills</a></div><div><br/></div><div>Best Regards.</div></body></html>